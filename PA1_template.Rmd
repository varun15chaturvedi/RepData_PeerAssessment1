---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
## Loading and preprocessing the data
```{r,cache=TRUE}
#Loading
data<-read.csv('activity.csv',header = T,colClasses = c('numeric','Date','character'))

#Preprocessing
interval_type1<- nchar(data$interval) %in% c(1,2)
interval_type2<- nchar(data$interval)== 3
interval_type3<- nchar(data$interval)==4

for (i in seq_along(data$interval)){
  if (interval_type1[i] == TRUE) {
    data$m_interval[i]<- paste('0',data$interval[i],sep =':' )
    
  }else if(interval_type2[i] == TRUE){
    split_interval<- strsplit(data$interval[i],split = '')
    i_min<- paste(split_interval[[1]][2],split_interval[[1]][3],sep ='' )
    i_hour<-split_interval[[1]][1]
    data$m_interval[i]<- paste(i_hour,i_min,sep =':' )
  }else if(interval_type3[i] == TRUE){
    split_interval<- strsplit(data$interval[i],split = '')
    i_min<- paste(split_interval[[1]][3],split_interval[[1]][4],sep ='' )
    i_hour<-paste(split_interval[[1]][1],split_interval[[1]][2],sep ='' )
    data$m_interval[i]<- paste(i_hour,i_min,sep =':' )
  }
}

data$date_time<- strftime(paste(data$date,data$m_interval,sep =' ' ),'%Y-%m-%d %H:%M')
```

## What is mean total number of steps taken per day?

```{r message=FALSE}
#install package dplyr using below command if not installed
#install.packages('dplyr')
library(dplyr)
```
```{r}
data<- group_by(data,date)
day_steps<-summarise(.data = data,count = sum(steps))
```
#### Histogram for No. of steps taken Each Day
```{r fig.height=5,fig.width=7}
hist(day_steps$count,breaks = 30,plot = T,freq = T,xlab ="Steps Count",
                          main = "Histogram of Every day Step Count ",col= "blue" )
day_mean<-summarise(.data = data,means= mean(steps,na.rm = TRUE))
day_median<- summarise(.data = data,median = median(steps,na.rm = TRUE))
```
```{r}
#Mean steps per day
day_mean
#median steps per day
day_median
```

## What is the average daily activity pattern?
```{r}
data$interval<- as.numeric(data$interval)
data = group_by(data,interval)
int_mean = summarise(.data = data ,means = mean(steps,na.rm = TRUE))
plot(int_mean$interval,int_mean$means,type= "l" ,xlab = 'Intervels',ylab = 'Average',main = 'Average Daily Activity Patters',col = 'blue')
```
#### Maximum number of steps

```{r}
max_steps=int_mean[int_mean$means==max(int_mean$means),1]
print(max_steps)
```

## Imputing missing values
#### No of NA in Dataset
```{r}
no_fo_NA = (which(is.na(data$steps)))
length(no_fo_NA)
```
#### Imputing NA`s with mean of that interval with Rounded values
```{r}
merge_data  = merge(data,int_mean)
# filling missing values
merge_data$steps[which(is.na(merge_data$steps))] = round(merge_data$means[which(is.na(merge_data$steps))])
# creating New dataset
new_dataset = merge_data[,c(2,3,1,4,5)]
new_dataset = arrange(.data = new_dataset,date)
```

```{r}
new_dataset<- group_by(new_dataset,date)
new_day_steps<-summarise(.data = new_dataset,count = sum(steps))
hist(new_day_steps$count,breaks = 30,plot = T,freq = T,xlab ="Steps Count",
                          main = "Histogram of Every day Step Count After Filling NA`s ",col= "blue" )
new_day_mean<-summarise(.data = new_dataset,means= mean(steps,na.rm = TRUE))
new_day_median<- summarise(.data = new_dataset,median = median(steps,na.rm = TRUE))
new_day_mean
new_day_median
```
New Values of mean and median are different from the previous values, because as missing values are replaced by means of that interval the sum of that interval got increased. this will effect mean and some values of median.

And the no. of steps each day incresed and histogram is more symmetric to center. 

## Are there differences in activity patterns between weekdays and weekends?

```{r}
# Adding new factor variable to dataset
new_dataset$weekday = weekdays(x = new_dataset$date,abbreviate = T)
new_dataset[new_dataset$weekday %in% c("Sun","Sat"),]$weekday ='weekends' 
new_dataset[new_dataset$weekday %in% c("Mon","Tue","Wed","Thu","Fri"),]$weekday ='weekdays' 
new_dataset$weekday<- as.factor(new_dataset$weekday)
```

```{r message= FALSE,cache= TRUE,fig.height= 4, fig.width=10}
# Adding package "ggplot2" to make plots
library(ggplot2)
#making plot
par(mfrow=c(1,2))
#weekdays
weekday_data <- new_dataset[new_dataset$weekday == "weekdays",]
weekday_data = group_by(weekday_data,interval)
weekday_mean = summarise(.data = weekday_data ,means = mean(steps,na.rm = TRUE))
plot(weekday_mean$interval,weekday_mean$means,type ="l",col = "blue",xlab = 'Intervels',ylab = 'Average steps on weekdays',main = 'Weekday Activity Patterns' )

# weekends
weekend_data <- new_dataset[new_dataset$weekday == "weekends",]
weekend_data = group_by(weekend_data,interval)
weekend_mean = summarise(.data = weekend_data ,means = mean(steps,na.rm = TRUE))
plot(weekend_mean$interval,weekend_mean$means,type ="l",col = "blue",xlab = 'Intervels',ylab = 'Average steps on weekends',main = 'Weekend Activity Patterns' )
```
As we see different patterns on **Weekdays** and **weekends** and people are more likely to walk more Weekdays.
For less movement on weekdays the office can be a reason,because when people reached to office do there work and have less time to walk But on weekends office are closed so people have good time to walk or play or mobile works.